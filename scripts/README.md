# Scripts
Scripts for taking notebook running regenie on output from `notebooks` files. `0*_` need only be run once and can be re-used. 

0. `00_merge_files.sh` Merge PLINK files for regenie step 1 as described in the [documentation](https://rgcgithub.github.io/regenie/recommendations/)
1. `01_fix_liftOver.sh` Deep down, bioinformatics is just wrangling in-compatible data formats. This fixes the GRCh38 chain file for Hail. Calls `fix_liftOver.py`
2. `02_liftOver_files.sh` lifts over UKB PLINK file from GRCh37 to 38. Takes about an hour and Spark fails a couple of times. Deal with it. Calls `liftOver.py`
3. `03_plink_qc.sh` use PLINK to QC output from `02` as per regenie recommendations.
4. `04_run_PHESANT.sh` pre-processes raw phenotype TSV files with [PHESANT](https://github.com/MRCIEU/PHESANT). See `notebooks/3a-c` for generating inout files. See `notebooks/04_fix_phesant_output.py` for making output compatible with regenie. 
5. `1a_regenie_step1_BT.sh` and `1b_regenie_step1_QT.sh` Requires .bim/.fam/.bed from `03`, covariates file from `notebooks/02_covariates.py`, phenotype file as ouput from `notebooks/04_fix_phesant.py`. Output .LOCO files requires for step 2 regenie. Takes a long-ass time for many phenotypes. 
6. `2a_regenie_step2_BT.sh` and `2b_regenie_step2_QT.sh`. Runs the actual burden analysis for either binary or quantitative traits. Requires processed phenotype file, .LOCO files output from step 1, covariates, .annotations, .setlist, .masks, .bgen, .sample files as generated by `notebooks/3a-c`. Outputs a bunch of .regenie files, one per phenotype which can be visualised by `notebooks/4_forest_plots.py`.


